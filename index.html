<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Space Grid Hub</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: black;
      height: 100%;
    }

    .viewport {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      position: relative;
      cursor: grab;
    }

    .zoom-container {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      transform-origin: center center;
      will-change: transform;
      backface-visibility: hidden;
    }

    .grid-stack {
      position: relative;
      width: 85vmin;
      height: 85vmin;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(17, 1fr);
      grid-template-rows: repeat(17, 1fr);
      width: 85vmin;
      height: 85vmin;
      position: absolute;
      top: 0;
      left: 0;
      z-index: 10;
    }

    .icon {
      grid-column: 9;
      grid-row: 9;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .icon svg {
      width: 100%;
      height: 100%;
      fill: white;
    }

    .button {
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      width: 100%;
      height: 100%;
      cursor: pointer;
    }

    .button img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .hover-overlay {
      position: absolute;
      width: 60%;
      height: 60%;
      opacity: 0;
      transition: opacity 0.3s;
      display: flex;
      justify-content: center;
      align-items: center;
      background: rgba(255, 255, 255, 0.8);
    }

    .hover-overlay img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .button:hover .hover-overlay {
      opacity: 1;
    }

    .button.active .hover-overlay {
      opacity: 1;
    }

    /* Disable hover and clicks when zoomed out */
    .zoomed-out .button {
      pointer-events: none;
    }

    .zoomed-out .button .hover-overlay {
      opacity: 0 !important;
    }

    /* Thumbnail Gallery */
    .thumbnail-gallery {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      padding: 10px;
      gap: 10px;
      overflow-x: auto;
      z-index: 1000;
    }

    .thumbnail-item {
      height: 60px;
      cursor: pointer;
    }

    .thumbnail-item img {
      height: 100%;
      width: auto;
      display: block;
    }

    /* Full Image Modal */
    .modal {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      max-width: 90%;
      max-height: 90%;
    }

    .modal-content img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .close-modal {
      position: absolute;
      top: 15px;
      right: 35px;
      color: #f1f1f1;
      font-size: 40px;
      font-weight: bold;
      cursor: pointer;
    }

    .close-modal:hover {
      color: #bbb;
    }

    /* Top branding elements */
    .top-branding {
      position: fixed;
      top: 20px;
      left: 20px;
      right: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
      pointer-events: none;
    }

    .top-branding img {
      height: 60px;
      width: auto;
      display: none;
    }

    .top-branding img.visible {
      display: block;
    }

    /* Button corner decorations */
    .button-with-corners {
      position: relative;
    }

    .button-with-corners::before,
    .button-with-corners::after,
    .button-corners::before,
    .button-corners::after {
      content: '';
      position: absolute;
      width: 10px;
      height: 10px;
      background: rgba(255, 255, 255, 0.9);
    }

    .button-with-corners::before {
      top: -5px;
      left: -5px;
    }

    .button-with-corners::after {
      top: -5px;
      right: -5px;
    }

    .button-corners {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .button-corners::before {
      bottom: -5px;
      left: -5px;
    }

    .button-corners::after {
      bottom: -5px;
      right: -5px;
    }

    /* Progress indicator */
    .progress-indicator {
      position: fixed;
      bottom: 120px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      color: black;
      padding: 12px 24px;
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: bold;
      z-index: 1000;
      display: none;
    }

    .progress-indicator.visible {
      display: block;
    }

    .progress-percentage {
      font-weight: bold;
    }

    /* Zoom out button */
    .zoom-out-button {
      position: fixed;
      bottom: 180px;
      right: 20px;
      background: rgba(255, 255, 255, 0.9);
      color: black;
      padding: 12px 24px;
      border: none;
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .zoom-out-button:hover {
      background: white;
      transform: scale(1.05);
    }

    .zoom-out-button:active {
      transform: scale(0.95);
    }

    /* Sobre IDAC button */
    .sobre-button {
      position: fixed;
      bottom: 180px;
      left: 20px;
      background: rgba(255, 255, 255, 0.9);
      color: black;
      padding: 12px 24px;
      border: none;
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      display: none;
    }

    .sobre-button.visible {
      display: block;
    }

    .sobre-button:hover {
      background: white;
      transform: scale(1.05);
    }

    .sobre-button:active {
      transform: scale(0.95);
    }

    /* Sobre IDAC Modal */
    .sobre-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 3000;
      overflow-y: auto;
    }

    .sobre-content {
      max-width: 900px;
      margin: 60px auto;
      padding: 60px;
      position: relative;
    }

    .sobre-close {
      position: absolute;
      top: 20px;
      right: 20px;
      color: white;
      font-size: 30px;
      cursor: pointer;
      font-family: Arial, sans-serif;
    }

    .sobre-close:hover {
      color: #ccc;
    }

    .sobre-text {
      color: white;
      font-family: Helvetica, Arial, sans-serif;
      font-size: 28px;
      line-height: 1.4;
      font-weight: normal;
      text-align: justify;
    }

    /* Entender IDAC button */
    .entender-button {
      position: fixed;
      bottom: 120px;
      left: 20px;
      background: rgba(255, 255, 255, 0.9);
      color: black;
      padding: 12px 24px;
      border: none;
      font-family: Arial, sans-serif;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 1000;
      display: none;
    }

    .entender-button.visible {
      display: block;
    }

    .entender-button:hover {
      background: white;
      transform: scale(1.05);
    }

    .entender-button:active {
      transform: scale(0.95);
    }

    /* Icon Creator Modal */
    .icon-creator-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      z-index: 3000;
      overflow-y: auto;
    }

    .icon-creator-content {
      max-width: 1000px;
      margin: 40px auto;
      padding: 40px;
      position: relative;
    }

    .icon-creator-close {
      position: absolute;
      top: 20px;
      right: 20px;
      color: white;
      font-size: 30px;
      cursor: pointer;
      font-family: Arial, sans-serif;
    }

    .icon-creator-close:hover {
      color: #ccc;
    }

    /* Icon Preview Section */
    .icon-preview-section {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 60px;
      margin-bottom: 60px;
    }

    .icon-preview {
      width: 400px;
      height: 400px;
      position: relative;
      flex-shrink: 0;
    }

    .icon-preview img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .icon-description {
      color: white;
      font-family: Helvetica, Arial, sans-serif;
      font-size: 14px;
      line-height: 1.6;
    }

    .icon-description-item {
      margin-bottom: 10px;
    }

    .icon-description-label {
      font-weight: bold;
      text-transform: uppercase;
    }

    /* Category Sections */
    .category-section {
      margin-bottom: 40px;
    }

    .category-title {
      color: white;
      font-family: Helvetica, Arial, sans-serif;
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 20px;
      text-transform: uppercase;
    }

    .category-buttons {
      display: grid;
      grid-template-columns: repeat(8, 1fr);
      gap: 15px;
    }

    .icon-toggle-button {
      width: 80px;
      height: 80px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 0;
      transition: opacity 0.3s ease;
    }

    .icon-toggle-button:hover {
      opacity: 0.7;
    }

    .icon-toggle-button.active {
      opacity: 1;
    }

    .icon-toggle-button:not(.active) {
      opacity: 0.4;
    }

    .icon-toggle-button img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    /* Reveal Grid Styles */
    .reveal-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 85vmin;
      height: 85vmin;
      z-index: 1;
    }

    .reveal-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('patron153.svg') center/cover no-repeat;
      image-rendering: crisp-edges;
      image-rendering: -webkit-crisp-edges;
      image-rendering: pixelated;
      will-change: transform;
      backface-visibility: hidden;
      transform: translateZ(0);
    }

    .reveal-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 2;
      image-rendering: crisp-edges;
      image-rendering: -webkit-crisp-edges;
      image-rendering: pixelated;
    }
  </style>
</head>
<body>
  <div class="viewport" id="viewport">
    <div class="zoom-container" id="zoomContainer">
      <div class="grid-stack">
        <!-- Reveal Grid (positioned behind button grid) -->
        <div class="reveal-container">
          <div class="reveal-background"></div>
          <canvas class="reveal-canvas" id="revealCanvas"></canvas>
        </div>

        <!-- Button Grid -->
        <div class="grid" id="grid">
          <div class="icon">
            <img src="LOGO.svg" alt="Logo" style="width: 100%; height: 100%; object-fit: contain;">
          </div>

          <!-- persona8 buttons -->
          <div class="button persona8-1" style="grid-column: 10; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-2" style="grid-column: 11; grid-row: 5;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-3" style="grid-column: 10; grid-row: 4;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-4" style="grid-column: 12; grid-row: 4;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-5" style="grid-column: 11; grid-row: 3;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-6" style="grid-column: 13; grid-row: 3;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-7" style="grid-column: 10; grid-row: 2;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-8" style="grid-column: 12; grid-row: 2;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona8-9" style="grid-column: 11; grid-row: 1;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- persona6 buttons -->
          <div class="button persona6-1" style="grid-column: 11; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-2" style="grid-column: 13; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-3" style="grid-column: 14; grid-row: 6;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-4" style="grid-column: 14; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-5" style="grid-column: 15; grid-row: 5;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-6" style="grid-column: 15; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-7" style="grid-column: 16; grid-row: 6;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-8" style="grid-column: 16; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button persona6-9" style="grid-column: 17; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Bianca buttons -->
          <div class="button bianca-1" style="grid-column: 11; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-2" style="grid-column: 13; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-3" style="grid-column: 14; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-4" style="grid-column: 14; grid-row: 12;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-5" style="grid-column: 15; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-6" style="grid-column: 15; grid-row: 13;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-7" style="grid-column: 16; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-8" style="grid-column: 16; grid-row: 12;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button bianca-9" style="grid-column: 17; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Mauricio buttons -->
          <div class="button mauricio-1" style="grid-column: 13; grid-row: 15;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-2" style="grid-column: 10; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-3" style="grid-column: 11; grid-row: 13;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-4" style="grid-column: 10; grid-row: 14;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-5" style="grid-column: 12; grid-row: 14;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-6" style="grid-column: 11; grid-row: 15;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-7" style="grid-column: 10; grid-row: 16;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-8" style="grid-column: 12; grid-row: 16;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mauricio-9" style="grid-column: 11; grid-row: 17;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Mateo buttons -->
          <div class="button mateo-1" style="grid-column: 8; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-2" style="grid-column: 7; grid-row: 13;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-3" style="grid-column: 6; grid-row: 14;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-4" style="grid-column: 8; grid-row: 14;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-5" style="grid-column: 5; grid-row: 15;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-6" style="grid-column: 7; grid-row: 15;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-7" style="grid-column: 6; grid-row: 16;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-8" style="grid-column: 8; grid-row: 16;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button mateo-9" style="grid-column: 7; grid-row: 17;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Claudia buttons -->
          <div class="button claudia-1" style="grid-column: 7; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-2" style="grid-column: 2; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-3" style="grid-column: 4; grid-row: 10;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-4" style="grid-column: 1; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-5" style="grid-column: 3; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-6" style="grid-column: 5; grid-row: 11;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-7" style="grid-column: 2; grid-row: 12;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-8" style="grid-column: 4; grid-row: 12;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button claudia-9" style="grid-column: 3; grid-row: 13;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Georgy buttons -->
          <div class="button georgy-1" style="grid-column: 7; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-2" style="grid-column: 3; grid-row: 5;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-3" style="grid-column: 2; grid-row: 6;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-4" style="grid-column: 4; grid-row: 6;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-5" style="grid-column: 1; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-6" style="grid-column: 3; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-7" style="grid-column: 5; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-8" style="grid-column: 2; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button georgy-9" style="grid-column: 4; grid-row: 8;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

          <!-- Gene buttons -->
          <div class="button gene-1" style="grid-column: 7; grid-row: 1;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-2" style="grid-column: 6; grid-row: 2;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-3" style="grid-column: 8; grid-row: 2;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-4" style="grid-column: 5; grid-row: 3;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-5" style="grid-column: 7; grid-row: 3;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-6" style="grid-column: 6; grid-row: 4;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-7" style="grid-column: 8; grid-row: 4;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-8" style="grid-column: 7; grid-row: 5;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>
          <div class="button gene-9" style="grid-column: 8; grid-row: 7;" data-thumbnail="pruebaplanoamplio.jpg">
            <img src="svgprueba.svg" alt="Button">
            <div class="hover-overlay">
              <img src="pruebacloseup.jpg" alt="Preview" />
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Top Branding -->
  <div class="top-branding">
    <img src="LOGO.svg" alt="Logo" id="topLogo" />
    <img src="WORDMARK.svg" alt="Wordmark" id="topWordmark" />
  </div>

  <!-- Sobre IDAC Button -->
  <button class="sobre-button button-with-corners" id="sobreButton">
    SOBRE IDAC
    <span class="button-corners"></span>
  </button>

  <!-- Sobre IDAC Modal -->
  <div class="sobre-modal" id="sobreModal">
    <div class="sobre-content">
      <span class="sobre-close" id="closeSobre">&times;</span>
      <div class="sobre-text">
        DAC presenta un mapeo comprehensivo de los rituales contemporáneos del agua en el contexto urbano, observados a través de ocho distintas personas. Se analizan tanto sus vínculos con los cuerpos, espacios y objetos que intervienen en dichos rituales, como las relaciones que estas personas establecen entre sí, conformando así un imaginario del agua en la ciudad. Este proyecto surge de una pregunta por los modos de imaginar el agua que atraviesa a la Ciudad de México y a algunas otras regiones que están implicadas en sus flujos; el proyecto es a la vez la representación de una polifonía de relaciones que provienen de diversos ritos desde los cuales nos acercamos a este elemento. El Imaginario del Agua en la Ciudad fue concebido como un experimento de codificación: una serie de pláticas a través de las cuales se buscó que aquello que ahí se codificara, cobrara espacio en nuestro imaginario colectivo que funge como un enlace directo a nuestro acercamiento a este líquido vital. Hoy, el poder en torno al acceso, gestión y simbolismo del agua en la Ciudad de México ha sido desplazado hacia nuevos actores que controlan sus flujos, disponibilidades y representaciones. En este contexto, rituales cotidianos vinculados al agua —como la recreación, la provisión, la sanidad, el gusto, la espiritualidad, el cuidado, la ornamentación y la petición— se configuran a partir de ritos contemporáneos que estructuran el imaginario del agua en la ciudad.
      </div>
    </div>
  </div>

  <!-- Entender IDAC Button -->
  <button class="entender-button button-with-corners" id="entenderButton">
    ENTENDER IDAC
    <span class="button-corners"></span>
  </button>

  <!-- Icon Creator Modal -->
  <div class="icon-creator-modal" id="iconCreatorModal">
    <div class="icon-creator-content">
      <span class="icon-creator-close" id="closeIconCreator">&times;</span>
      
      <!-- Icon Preview Section -->
      <div class="icon-preview-section">
        <div class="icon-preview" id="iconPreview">
          <img id="personaLayer" style="display: none;" />
          <img id="ritoLayer" style="display: none;" />
          <img id="ritualLayer" style="display: none;" />
        </div>
        
        <div class="icon-description" id="iconDescription">
          <div class="icon-description-item">
            <span class="icon-description-label">PERSONA:</span> <span id="personaText">-</span>
          </div>
          <div class="icon-description-item">
            <span class="icon-description-label">RITO:</span> <span id="ritoText">-</span>
          </div>
          <div class="icon-description-item">
            <span class="icon-description-label">RITUAL:</span> <span id="ritualText">-</span>
          </div>
        </div>
      </div>
      
      <!-- Category: Persona -->
      <div class="category-section">
        <div class="category-title">PERSONA</div>
        <div class="category-buttons" id="personaButtons">
          <button class="icon-toggle-button" data-category="persona" data-index="1">
            <img src="PERSONAICONO1.svg" alt="Persona 1" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="2">
            <img src="PERSONAICONO2.svg" alt="Persona 2" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="3">
            <img src="PERSONAICONO3.svg" alt="Persona 3" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="4">
            <img src="PERSONAICONO4.svg" alt="Persona 4" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="5">
            <img src="PERSONAICONO5.svg" alt="Persona 5" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="6">
            <img src="PERSONAICONO6.svg" alt="Persona 6" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="7">
            <img src="PERSONAICONO7.svg" alt="Persona 7" />
          </button>
          <button class="icon-toggle-button" data-category="persona" data-index="8">
            <img src="PERSONAICONO8.svg" alt="Persona 8" />
          </button>
        </div>
      </div>
      
      <!-- Category: Rito -->
      <div class="category-section">
        <div class="category-title">RITO</div>
        <div class="category-buttons" id="ritoButtons">
          <button class="icon-toggle-button" data-category="rito" data-index="1">
            <img src="RITOICONO1.svg" alt="Rito 1" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="2">
            <img src="RITOICONO2.svg" alt="Rito 2" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="3">
            <img src="RITOICONO3.svg" alt="Rito 3" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="4">
            <img src="RITOICONO4.svg" alt="Rito 4" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="5">
            <img src="RITOICONO5.svg" alt="Rito 5" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="6">
            <img src="RITOICONO6.svg" alt="Rito 6" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="7">
            <img src="RITOICONO7.svg" alt="Rito 7" />
          </button>
          <button class="icon-toggle-button" data-category="rito" data-index="8">
            <img src="RITOICONO8.svg" alt="Rito 8" />
          </button>
        </div>
      </div>
      
      <!-- Category: Ritual -->
      <div class="category-section">
        <div class="category-title">RITUAL</div>
        <div class="category-buttons" id="ritualButtons">
          <button class="icon-toggle-button" data-category="ritual" data-index="1">
            <img src="RITUALICONO1.svg" alt="Ritual 1" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="2">
            <img src="RITUALICONO2.svg" alt="Ritual 2" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="3">
            <img src="RITUALICONO3.svg" alt="Ritual 3" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="4">
            <img src="RITUALICONO4.svg" alt="Ritual 4" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="5">
            <img src="RITUALICONO5.svg" alt="Ritual 5" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="6">
            <img src="RITUALICONO6.svg" alt="Ritual 6" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="7">
            <img src="RITUALICONO7.svg" alt="Ritual 7" />
          </button>
          <button class="icon-toggle-button" data-category="ritual" data-index="8">
            <img src="RITUALICONO8.svg" alt="Ritual 8" />
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Progress Indicator -->
  <div class="progress-indicator button-with-corners" id="progressIndicator">
    imaginario construido <span class="progress-percentage" id="progressPercentage">0%</span>
    <span class="button-corners"></span>
  </div>

  <!-- Zoom Out Button -->
  <button class="zoom-out-button button-with-corners" id="zoomOutButton">
    Ver Progreso
    <span class="button-corners"></span>
  </button>

  <!-- Thumbnail Gallery -->
  <div class="thumbnail-gallery" id="thumbnailGallery"></div>

  <!-- Full Image Modal -->
  <div id="imageModal" class="modal">
    <span class="close-modal">&times;</span>
    <div class="modal-content">
      <img id="modalImage" src="" alt="Full size image">
    </div>
  </div>

  <script>
    const zoomContainer = document.getElementById('zoomContainer');
    let scale = 9;
    let isPanning = false;
    let startX, startY, translateX = 0, translateY = 0;
    let isZoomedOut = false;
    const normalScale = 9;
    const zoomedOutScale = 1;
    
    zoomContainer.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;

    // Zoom out button functionality
    const zoomOutButton = document.getElementById('zoomOutButton');
    const progressIndicator = document.getElementById('progressIndicator');
    const entenderButton = document.getElementById('entenderButton');
    const sobreButton = document.getElementById('sobreButton');
    const topLogo = document.getElementById('topLogo');
    const topWordmark = document.getElementById('topWordmark');
    
    zoomOutButton.addEventListener('click', () => {
      if (isZoomedOut) {
        // Zoom back in
        scale = normalScale;
        zoomOutButton.textContent = 'Ver Progreso';
        progressIndicator.classList.remove('visible');
        entenderButton.classList.remove('visible');
        sobreButton.classList.remove('visible');
        topLogo.classList.remove('visible');
        topWordmark.classList.remove('visible');
        viewport.classList.remove('zoomed-out');
        isZoomedOut = false;
        // Smooth transition when zooming in
        zoomContainer.style.transition = 'transform 0.3s ease';
      } else {
        // Zoom out to see full grid
        scale = zoomedOutScale;
        translateX = 0;
        translateY = 0;
        zoomOutButton.textContent = 'Volver';
        progressIndicator.classList.add('visible');
        entenderButton.classList.add('visible');
        sobreButton.classList.add('visible');
        topLogo.classList.add('visible');
        topWordmark.classList.add('visible');
        viewport.classList.add('zoomed-out');
        isZoomedOut = true;
        // Smooth transition when zooming out
        zoomContainer.style.transition = 'transform 0.3s ease';
      }
      zoomContainer.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
      
      // Remove transition after animation completes
      setTimeout(() => {
        zoomContainer.style.transition = 'none';
      }, 300);
    });

    const viewport = document.getElementById('viewport');

    // Panning functionality with trackpad/wheel
    window.addEventListener('wheel', (e) => {
      if (isZoomedOut) return;
      e.preventDefault();
      
      // Update translation based on wheel delta
      translateX -= e.deltaX;
      translateY -= e.deltaY;
      
      zoomContainer.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
    }, { passive: false });

    // Keep mouse drag as alternative panning method
    viewport.addEventListener('mousedown', (e) => {
      if (e.target.closest('.button') || isZoomedOut) return;
      isPanning = true;
      startX = e.clientX - translateX;
      startY = e.clientY - translateY;
      viewport.style.cursor = 'grabbing';
    });

    viewport.addEventListener('mouseup', () => {
      isPanning = false;
      viewport.style.cursor = 'grab';
    });

    viewport.addEventListener('mouseleave', () => {
      isPanning = false;
      viewport.style.cursor = 'grab';
    });

    viewport.addEventListener('mousemove', (e) => {
      if (!isPanning || isZoomedOut) return;
      translateX = e.clientX - startX;
      translateY = e.clientY - startY;
      zoomContainer.style.transform = `translate(${translateX}px, ${translateY}px) scale(${scale})`;
    });

    // Add click event listeners to buttons
    const buttonStates = new Map(); // Track which buttons are active
    const thumbnailMap = new Map(); // Track thumbnails by button ID

    document.querySelectorAll('.button').forEach(button => {
      button.addEventListener('click', (e) => {
        e.stopPropagation();
        const buttonId = button.className.split(' ').find(cls => cls !== 'button' && cls !== 'active');
        const thumbnailSrc = button.getAttribute('data-thumbnail');
        
        if (buttonStates.has(buttonId)) {
          // Button is active, deactivate it
          button.classList.remove('active');
          buttonStates.delete(buttonId);
          
          // Remove the thumbnail
          const thumbnail = thumbnailMap.get(buttonId);
          if (thumbnail) {
            thumbnail.remove();
            thumbnailMap.delete(buttonId);
          }
          
          // Update progress
          updateProgress();
        } else {
          // Button is not active, activate it
          button.classList.add('active');
          buttonStates.set(buttonId, true);
          
          // Add thumbnail if it doesn't exist
          if (!thumbnailMap.has(buttonId)) {
            addThumbnail(thumbnailSrc, buttonId);
          }
          
          // Update progress
          updateProgress();
        }
      });
    });

    // Thumbnail gallery functionality
    const thumbnailGallery = document.getElementById('thumbnailGallery');
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');
    const closeModal = document.querySelector('.close-modal');

    function addThumbnail(imageSrc, buttonId) {
      const thumbnail = document.createElement('div');
      thumbnail.className = 'thumbnail-item';
      thumbnail.innerHTML = `<img src="${imageSrc}" alt="${buttonId}" />`;
      
      thumbnail.addEventListener('click', () => {
        modalImage.src = imageSrc;
        modal.style.display = 'block';
      });

      thumbnailGallery.appendChild(thumbnail);
      thumbnailMap.set(buttonId, thumbnail); // Store reference to thumbnail
    }

    // Modal functionality
    closeModal.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && modal.style.display === 'block') {
        modal.style.display = 'none';
      }
    });

    // Reveal grid functionality
    const canvas = document.getElementById('revealCanvas');
    const ctx = canvas.getContext('2d', { alpha: true });
    ctx.imageSmoothingEnabled = false;
    const GRID_SIZE = 153;
    let revealed = new Set();
    let animationFrame = null;

    function updateCanvasSize() {
      const container = canvas.parentElement;
      const rect = container.getBoundingClientRect();
      
      // Set canvas size to match container
      canvas.width = rect.width;
      canvas.height = rect.height;
      
      // Disable image smoothing for crisp pixels
      ctx.imageSmoothingEnabled = false;
      
      drawGrid();
    }

    function drawGrid() {
      // Cancel any pending animation frame
      if (animationFrame) {
        cancelAnimationFrame(animationFrame);
      }
      
      animationFrame = requestAnimationFrame(() => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = 'black';

        const cellSize = canvas.width / GRID_SIZE;

        for (let y = 0; y < GRID_SIZE; y++) {
          for (let x = 0; x < GRID_SIZE; x++) {
            const key = `${x},${y}`;
            if (!revealed.has(key)) {
              ctx.fillRect(
                Math.floor(x * cellSize), 
                Math.floor(y * cellSize), 
                Math.ceil(cellSize) + 1, 
                Math.ceil(cellSize) + 1
              );
            }
          }
        }
        
        // Update progress percentage
        updateProgress();
      });
    }

    function updateProgress() {
      const totalButtons = 72; // Total number of buttons (9 buttons × 8 people)
      const activeButtons = buttonStates.size;
      const percentage = Math.round((activeButtons / totalButtons) * 100);
      document.getElementById('progressPercentage').textContent = percentage + '%';
    }

    function revealAtMouse(e) {
      if (isZoomedOut) return; // Disable reveal when zoomed out
      
      const rect = canvas.getBoundingClientRect();
      const containerRect = canvas.parentElement.getBoundingClientRect();
      
      const mx = e.clientX - containerRect.left;
      const my = e.clientY - containerRect.top;

      const cellSize = rect.width / GRID_SIZE;
      const radiusCells = 2;
      const radiusPx = radiusCells * cellSize;

      for (let y = 0; y < GRID_SIZE; y++) {
        for (let x = 0; x < GRID_SIZE; x++) {
          const cx = x * cellSize + cellSize / 2;
          const cy = y * cellSize + cellSize / 2;
          const dx = mx - cx;
          const dy = my - cy;
          const dist = Math.sqrt(dx * dx + dy * dy);

          if (dist <= radiusPx) {
            revealed.add(`${x},${y}`);
          }
        }
      }

      drawGrid();
    }

    // Initialize reveal canvas
    setTimeout(() => {
      updateCanvasSize();
    }, 100);

    window.addEventListener('resize', () => {
      setTimeout(updateCanvasSize, 100);
    });

    zoomContainer.addEventListener('mousemove', (e) => {
      if (!isZoomedOut) {
        revealAtMouse(e);
      }
    });

    const originalTransform = zoomContainer.style.transform;
    const observer = new MutationObserver(() => {
      if (zoomContainer.style.transform !== originalTransform) {
        setTimeout(updateCanvasSize, 50);
      }
    });
    observer.observe(zoomContainer, { attributes: true, attributeFilter: ['style'] });

    // Sobre IDAC functionality
    const sobreModal = document.getElementById('sobreModal');
    const closeSobre = document.getElementById('closeSobre');

    sobreButton.addEventListener('click', () => {
      sobreModal.style.display = 'block';
    });

    closeSobre.addEventListener('click', () => {
      sobreModal.style.display = 'none';
    });

    sobreModal.addEventListener('click', (e) => {
      if (e.target === sobreModal) {
        sobreModal.style.display = 'none';
      }
    });

    // Icon Creator functionality
    const iconCreatorModal = document.getElementById('iconCreatorModal');
    const closeIconCreator = document.getElementById('closeIconCreator');
    const selectedIcons = {
      persona: null,
      rito: null,
      ritual: null
    };

    // Define the names/descriptions for each icon
    const iconNames = {
      persona: {
        1: 'Persona 1',
        2: 'Persona 2', 
        3: 'Persona 3',
        4: 'Persona 4',
        5: 'Persona 5',
        6: 'Persona 6',
        7: 'Persona 7',
        8: 'Persona 8'
      },
      rito: {
        1: 'Rito 1',
        2: 'Rito 2',
        3: 'Rito 3',
        4: 'Rito 4',
        5: 'Rito 5',
        6: 'Rito 6',
        7: 'Rito 7',
        8: 'Rito 8'
      },
      ritual: {
        1: 'Ritual 1',
        2: 'Ritual 2',
        3: 'Ritual 3',
        4: 'Ritual 4',
        5: 'Ritual 5',
        6: 'Ritual 6',
        7: 'Ritual 7',
        8: 'Ritual 8'
      }
    };

    // Open icon creator
    entenderButton.addEventListener('click', () => {
      iconCreatorModal.style.display = 'block';
    });

    // Close icon creator
    closeIconCreator.addEventListener('click', () => {
      iconCreatorModal.style.display = 'none';
    });

    iconCreatorModal.addEventListener('click', (e) => {
      if (e.target === iconCreatorModal) {
        iconCreatorModal.style.display = 'none';
      }
    });

    // Icon toggle buttons
    document.querySelectorAll('.icon-toggle-button').forEach(button => {
      button.addEventListener('click', () => {
        const category = button.dataset.category;
        const index = button.dataset.index;
        
        // Remove active class from all buttons in this category
        document.querySelectorAll(`.icon-toggle-button[data-category="${category}"]`).forEach(btn => {
          btn.classList.remove('active');
        });
        
        // Add active class to clicked button
        button.classList.add('active');
        
        // Update selected icon
        selectedIcons[category] = index;
        
        // Update preview
        updateIconPreview();
      });
    });

    function updateIconPreview() {
      const personaLayer = document.getElementById('personaLayer');
      const ritoLayer = document.getElementById('ritoLayer');
      const ritualLayer = document.getElementById('ritualLayer');
      
      // Update persona layer
      if (selectedIcons.persona) {
        personaLayer.src = `PERSONAICONO${selectedIcons.persona}.svg`;
        personaLayer.style.display = 'block';
        document.getElementById('personaText').textContent = iconNames.persona[selectedIcons.persona];
      } else {
        personaLayer.style.display = 'none';
        document.getElementById('personaText').textContent = '-';
      }
      
      // Update rito layer
      if (selectedIcons.rito) {
        ritoLayer.src = `RITOICONO${selectedIcons.rito}.svg`;
        ritoLayer.style.display = 'block';
        document.getElementById('ritoText').textContent = iconNames.rito[selectedIcons.rito];
      } else {
        ritoLayer.style.display = 'none';
        document.getElementById('ritoText').textContent = '-';
      }
      
      // Update ritual layer
      if (selectedIcons.ritual) {
        ritualLayer.src = `RITUALICONO${selectedIcons.ritual}.svg`;
        ritualLayer.style.display = 'block';
        document.getElementById('ritualText').textContent = iconNames.ritual[selectedIcons.ritual];
      } else {
        ritualLayer.style.display = 'none';
        document.getElementById('ritualText').textContent = '-';
      }
    }
  </script>
</body>
</html>